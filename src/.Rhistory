paste0(subdat$Location, "(", round(list_percentile*100), "th percentile")")
)
name_herbicide = list_herbicides[1]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
name_herbicide
list_herbicides
name_herbicide = list_herbicides[1]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
#plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
#plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat$Clethodim_SURVIVAL_RATE[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat$Clethodim_SURVIVAL_RATE[i])/length(resistance))
}
name_herbicide = list_herbicides[1]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
#plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat$Clethodim_SURVIVAL_RATE[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat$Clethodim_SURVIVAL_RATE[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, "(", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[1]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat$Clethodim_SURVIVAL_RATE[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat$Clethodim_SURVIVAL_RATE[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
name_herbicide = list_herbicides[2]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
#for (name_herbicide in list_herbicides){
name_herbicide = list_herbicides[2]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat$Clethodim_SURVIVAL_RATE[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat$Clethodim_SURVIVAL_RATE[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
#}
#for (name_herbicide in list_herbicides){
name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
resistance
fname_data = "../res/test_data_Lrigidum_20200910.txt"
name_farmer = "Adam"
list_herbicides = c("Clethodim_SURVIVAL_RATE", "Glyphosate_SURVIVAL_RATE", "Sulfometuron_SURVIVAL_RATE", "Terbuthylazine_SURVIVAL_RATE")
dat = read.delim(fname_data, header=TRUE, na.string="#N/A")
subdat = dat[dat$Farmer_Agronomist==name_farmer, ]
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat$Clethodim_SURVIVAL_RATE[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat$Clethodim_SURVIVAL_RATE[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
subdat_resistance
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
continue
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat$Clethodim_SURVIVAL_RATE[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat$Clethodim_SURVIVAL_RATE[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
break
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat$Clethodim_SURVIVAL_RATE[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat$Clethodim_SURVIVAL_RATE[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
break
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
name_herbicide = list_herbicides[3]
resistance
subdat_resistance
sum(!is.na(subdat_resistance))
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
break
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
print(name_herbicide)
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
subdat_resistance
name_herbicide
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
print(name_herbicide)
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
print(name_herbicide)
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
print(name_herbicide)
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
list_herbicides
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
print(name_herbicide)
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
subdat_resistance
list_percentile = c()
for (i in 1:nrow(subdat)){
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
list_percentile
subdat_resistance
resistance
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location, " (", round(list_percentile*100), "th percentile)"), col=list_colors, lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (", round(list_percentile[!is.na(subdat_resistance)]*100), "th percentile)"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)]*100), ")"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)],2), ")"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)]*100), "%)"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), nclasses=100, bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)]*100), "%)"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
?hist
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), nclass=100, bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)]*100), "%)"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
next
}
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), nclass=10, bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)]*100), "%)"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
plot(x=0:1, y=0:1, type="n", xlab="", ylab="")
text(x=0.5, y=0.5, lab="NO DATA")
} else {
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), nclass=10, bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)]*100), "%)"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
}
par(mfrow=c(2,2))
for (name_herbicide in list_herbicides){
# name_herbicide = list_herbicides[3]
resistance = eval(parse(text=paste0("dat$", name_herbicide)))
resistance = resistance[!is.na(resistance)]
subdat_resistance = eval(parse(text=paste0("subdat$", name_herbicide)))
if (sum(!is.na(subdat_resistance))==0){
plot(x=0:1, y=0:1, type="n", xlab=name_herbicide, ylab="")
text(x=0.5, y=0.5, lab="NO DATA")
} else {
# plot(density(resistance, adjust=1), main="", xlab=name_herbicide)
hist(resistance, col=rgb(0.5,0.5,0.5,alpha=0.6), nclass=10, bord=FALSE, main="", xlab=name_herbicide)
grid()
list_colors = rainbow(nrow(subdat))
list_percentile = c()
for (i in 1:nrow(subdat)){
abline(v=subdat_resistance[i], col=list_colors[i], lwd=2)
list_percentile = c(list_percentile, sum(resistance<=subdat_resistance[i])/length(resistance))
}
legend("topright", legend=paste0(subdat$Location[!is.na(subdat_resistance)], " (percentile=", round(list_percentile[!is.na(subdat_resistance)]*100), "%)"), col=list_colors[!is.na(subdat_resistance)], lwd=2)
}
}
